## .bash_profile和.bashrc  
**编号：**T1546.004  
**战术：**提权（Privilege Escalation)  
**数据源：**文件监视，进程命令行参数，进程监视，网络进程使用  
**基本描述：**在打开新shell或用户登录时，会在用户的环境中执行~/.bash_profile和~/.bashrc，以便正确设置其环境。 ~/.bash_profile用于登录shell，而~/.bashrc在交互式非登录shell中执行。这意味着当用户（通过用户名和密码）登录到控制台（本地或通过SSH之类的远程）时，在初始命令提示符返回给用户前会执行~/.bash_profile。在登录之后，每当打开一个新shell时，就会执行~/.bashrc。这允许用户更细粒度地控制何时执行特定命令。Mac的Terminal.app略有不同，默认情况下，每次打开一个新的终端窗口都会启动登录shell，因此调用的是~/.bash_profile而不是~/.bashrc。 这些文件应该由本地用户写入来配置自己的环境；但是，攻击者也可以向这些文件中插入代码，以便在每次用户登录或打开新的shell时获得持久性。  
## 检测建议  
虽然用户可以自定义~/.bashrc 和~/.bash_profile 文件，但通常只有特定类型的命令会出现在这些文件中。 
监视异常命令，比如在登录过程中加载用户配置文件时执行未知程序、打开网络套接字或跨网络访问。  
## 检测方式  
规则