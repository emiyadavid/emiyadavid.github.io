## 反射代码加载  
**编号：**T1620  
**战术：**防御规避（Defense Evasion)  
**数据源：**进程监视，脚本文件，模块加载  
**基本描述：**攻击者可能会反射性地将代码加载到进程中，以隐藏恶意负载的执行。反射加载涉及直接在进程的内存中分配然后执行有效负载，即创建一个线程或由磁盘上的文件路径支持的进程。反射加载的有效载荷可能是编译后的二进制文件、匿名文件（仅存在于 RAM 中），或者只是无文件可执行代码（例如：位置无关的 shellcode）。
反射代码注入与进程注入非常相似，不同之处在于“注入”将代码加载到进程自己的内存中，而不是单独进程的内存中。反射加载可能会逃避基于进程的检测，因为任意代码的执行可能会在合法或其他良性进程中被屏蔽。反射性地将有效负载直接加载到内存中还可以避免在磁盘上创建文件或其他工件，同时还使恶意软件能够在执行之前保持这些有效负载加密（或以其他方式混淆）。  
## 检测建议  
监视与反射加载代码相关的代码工件，例如滥用 .NET 函数（如 Assembly.Load()）和本机 API 函数（如 CreateThread()、memfd_create()、execve() 和/或 execveat()）。
监控异常流程执行的工件。
分析进程行为以确定进程是否正在执行通常不执行的操作，例如打开网络连接、读取文件或其他可能与入侵后行为相关的可疑操作。  
## 检测方式  
规则