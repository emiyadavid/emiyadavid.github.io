## 劫持SIP和信托提供商  
**编号：**T1553.003  
**战术：**防御规避（Defense Evasion)  
**数据源：**API监视，应用程序日志，DLL监视，加载的DLL，进程监视，Windows注册表，Windows事件日志  
**基本描述：**由于可执行文件的类型和相应的签名格式各不相同，Microsoft创建了称为主题接口包（SIP）软件组件，以在API函数和文件之间提供抽象层。SIP负责使API函数能够创建，检索，计算和验证签名。大多数文件格式都具有唯一的SIP（可执行文件，PowerShell，安装程序等），并且由全局唯一标识符（GUID）标识。
在用户模式下，Windows Authenticode 数字签名用于验证文件的来源和完整性，这些变量可用于建立对签名代码的信任。签名验证过程是通过WinVerifyTrust应用程序编程接口（API）函数处理的，该函数接受查询并与负责验证签名参数的信任提供者进行协调。
攻击者可能会滥用此体系结构来破坏信任控制并绕过仅允许合法签名的代码在系统上执行的安全策略。攻击者可能会劫持SIP和信任提供程序组件，来误导操作系统和应用程序控制工具对恶意（或任何）代码进行错误的分类。  
## 检测建议  
对注册的SIP和信任提供者（注册表项和磁盘上的文件）做定期的基线更新。
启用CryptoAPI v2（CAPI）事件日志记录来监视和分析与失败的信任验证有关的错误事件。
  
## 检测方式  
规则