## 资源分叉  
**编号：**T1564.009  
**战术：**防御规避（Defense Evasion)  
**数据源：**文件监视，进程命令行参数，进程监视  
**基本描述：**攻击者可能会滥用资源分叉来隐藏恶意代码或可执行文件以逃避检测并绕过安全应用程序。资源分叉为应用程序提供了一种结构化的方式来存储资源，例如缩略图、菜单定义、图标、对话框和代码。使用 ls -l@ 或 xattr -l 命令显示文件的扩展属性时，可以识别资源分支的使用。资源分叉已被弃用并替换为应用程序包结构。非本地化资源放置在应用程序包的顶级目录中，而本地化资源放置在 /Resources 文件夹中。
攻击者可以使用资源分叉来隐藏可能直接存储在文件中的恶意数据。攻击者可以使用附加的资源分叉在指定的偏移处执行内容，然后将其移动到可执行位置然后调用。资源分叉内容也可能被混淆/加密，直到执行。
  
## 检测建议  
使用 com.apple.ResourceFork 扩展属性和存储在资源分支中的大量数据来识别文件。
利用资源分叉监控命令行活动，尤其是那些紧随其后的潜在恶意活动，例如创建网络连接。  
## 检测方式  
规则