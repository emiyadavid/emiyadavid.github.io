## 线程局部存储  
**编号：**T1055.005  
**战术：**防御规避（Defense Evasion)  
**数据源：**API监视，进程监视  
**基本描述：**线程局部存储（TLS）是一种变量的存储方法，这个变量在它所在的线程内是全局可访问的，但是不能被其他线程访问到，这样就保持了数据的线程独立性。TLS回调注入是一种在单独的活动进程的地址空间中执行任意代码的方法。TLS回调注入会在PE文件中操纵指针，使得代码到达合法入口点之前将进程重定向到恶意代码。  
## 检测建议  
分析进程行为，来确定某个进程是否正在执行其通常不执行的动作，例如打开网络连接，读取文件或其他可能与破坏后行为相关的可疑动作。
监视Windows API的调用情况，尤其是修改内存的API（如Write ProcessMemory）。虽然会有一定效果，但是会产生大量数据对于判定是否为恶意代码植入所为的用处较小。  
## 检测方式  
规则