## Gatekeeper绕过  
**编号：**T1553.001  
**战术：**防御规避（Defense Evasion)  
**数据源：**文件监视，处理命令行参数  
**基本描述：**在macOS和OS X中，从Internet下载应用程序或程序时，在文件上设置了特殊属性名为com.apple.quarantine。苹果的Gatekeeper防御程序会在执行时读取此属性，并向用户提示允许或拒绝执行。
但是，从USB闪存驱动器，光盘，外部硬盘驱动器甚至从本地网络共享的驱动器加载到系统上的应用程序都不会设置此标志。此外，其他实用程序或事件也不一定要对其进行设置。
此外，给定sudo访问权限或提升的权限，也可以使用xattr删除此属性。
攻击者可能会修改这些文件属性来隐藏不受信任来源的信息，从而破坏了Gatekeeper控件。  
## 检测建议  
由用户（而不是操作系统）监视删除标志com.apple.quarantine的行为是可疑的操作
监视和调查使用实用程序（例如）修改扩展文件属性的尝试xattr。
  
## 检测方式  
规则