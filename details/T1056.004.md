## 凭证API劫持  
**编号：**T1056.004  
**战术：**收集（Collection）  
**数据源：**API监视，二进制文件元数据，DLL监视，加载的DLL，进程监视，Windows事件日志  
**基本描述：**攻击者可能会使用Windows API功能来收集用户凭据。恶意挂钩机制可能会捕获API调用，这些API调用包含了用户身份验证凭据的参数。与键盘记录不同，此技术专门针对API函数，这些函数包括显示用户凭据的参数。劫持技术涉及将调用重定向到这些函数，可以通过以下方式实现：
1.挂钩程序：可响应消息，按键和鼠标输入等事件来拦截并执行指定的代码；
2.导入地址表（IAT）挂钩：对进程的IAT进行修改，存储了指向导入的API函数的指针。
3.内联挂钩：它会覆盖API函数中的第一个字节来重定向代码流。  
## 检测建议  
监视对SetWindowsHookEx和SetWinEventHook函数的调用，这些函数用来安装挂钩程序；
使用Rootkits检测器来检测劫持行为；
  
## 检测方式  
规则