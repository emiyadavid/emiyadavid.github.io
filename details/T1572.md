## 协议隧道  
**编号：**T1572  
**战术：**命令与控制（Command & Control）  
**数据源：**流量分析，网络协议分析，数据包捕获，进程监控，网络进程使用  
**基本描述：**攻击者可以在单独的协议中通过隧道与受害者系统进行网络通信，从而避免检测/网络过滤和/或实现对其他系统无法访问。隧道是指将一种协议明确封装在另一个协议中进行传输。此行为可能通过与现有流量混合来掩盖恶意流量和/或提供加密的外层（类似于VPN）。
有多种将协议封装在另一个协议中的方法。例如，攻击者可能执行SSH隧道（也称为SSH端口转发），这涉及通过加密的SSH隧道转发任意数据。
攻击者还可以结合代理和/或协议模拟来利用协议隧道来进一步隐藏C2通信和基础结构。  
## 检测建议  
分析不常见的网络数据流（例如，客户端发送的数据远多于从服务器接收的数据）；
监视可疑进程（从未见过；没有网络通信功能却有网络行为）；
分析数据包内容来检测应用层协议内容中未遵循有关语法，结构或任何其他攻击者可能隐藏数据的变量；
监视系统中通常与隧道关联的端口/协议（例如SSH端口22）；
监视通常与隧道关联的进程，例如Plink和OpenSSH客户端。  
## 检测方式  
规则、模型