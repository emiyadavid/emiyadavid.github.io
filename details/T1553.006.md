## 代码签名策略修改  
**编号：**T1553.006  
**战术：**防御规避（Defense Evasion)  
**数据源：**进程监视，Windows注册表，命令行参数  
**基本描述：**攻击者可以修改代码签名策略，来执行未签名或自签名的代码。
系统的安全控制可以包括强制执行机制，来确保只有有效的，经过签名的代码可以在操作系统上运行。其中一些安全控件可能默认情况下处于启用状态，例如Windows上的驱动程序签名强制（DSE）或macOS上的系统完整性保护（SIP）。其他此类控件可能默认情况下处于禁用状态，但可以通过应用程序控件进行配置，例如仅允许签名的动态链接库（DLL）在系统上执行。
攻击者可以多种方式修改代码签名策略，包括使用命令行或GUI实用程序，修改注册表，以在调试/恢复模式重新启动计算机，或更改内核内存中变量的值。可以修改系统代码签名策略的命令示例包括Windows上的bcdedit.exe -set TESTSIGNING ON和macOS上的csrutil disable。根据实现的不同，成功修改签名策略可能需要重新启动受感染的系统。此外，某些实现可能会为用户引入可见的工件。攻击者会尝试移除这些工件。  
## 检测建议  
监视进程和命令行参数来了解可以采取哪些措施来修改系统的代码签名策略，例如bcdedit.exe -set TESTSIGNING ON
监视对与代码签名策略（例如HKCU\Software\Policies\Microsoft\Windows NT\Driver Signing）关联的注册表项所做的修改。
对系统代码签名策略的修改可能很少。  
## 检测方式  
规则