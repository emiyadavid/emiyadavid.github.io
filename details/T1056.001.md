## 键盘记录  
**编号：**T1056.001  
**战术：**收集（Collection）  
**数据源：**API监视，进程监视，Windows注册表  
**基本描述：**攻击者可以使用捕获用户输入的方法来获取有效帐户的凭据和收集信息，包括键盘记录和用户输入字段拦截。键盘记录是最常见的输入捕获类型，有许多不同的方法来拦截击键，但也有针对特定的目的来获取信息的其他方法：
1.拦截处理击键的API回调；
2.从硬件缓冲区读取原始的击键数据；
3.Windows注册表修改；
4.自定义驱动程序；
5.Modify System Image为攻击者提供了进入网络设备操作系统的挂钩，来读取登录会话的原始击键。  
## 检测建议  
使用白名单或工具，如 AppLocker， 或软件限制策略 ，识别和拦截可能用于从用户处获取凭据或信息的潜在恶意软件。
键盘记录程序可以采用多种形式，可能涉及修改注册表和安装驱动程序，设置挂钩或轮询来拦截键盘输入。检测相关常用API：SetWindowsHook, GetKeyState和 GetAsyncKeyState；
监视注册表和文件系统的更改；监视驱动程序的安装。  
## 检测方式  
规则