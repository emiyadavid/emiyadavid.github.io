## trap  
**编号：**T1546.005  
**战术：**提权（Privilege Escalation)  
**数据源：**文件监视，进程命令行参数，进程监视  
**基本描述：**trap命令使程序和shell可以指定接收中断信号时执行的命令。一种常见的情况是脚本允许正常终止和处理常见的键盘中断，如ctrl+c和ctrl+d。当 shell 遇到特定的中断时，攻击者可以使用它来注册要执行的代码，以获得执行或作为持久性机制。Trap命令的格式如下：trap“命令列表”signals，当接收时到“signals”，将执行“命令列表”。  
## 检测建议  
必须为shell或程序注册trap命令。
监视文件是否存在可疑或过于宽泛的trap命令可以减少调查期间的可疑行为。监视通过trap中断执行的可疑进程。  
## 检测方式  
规则