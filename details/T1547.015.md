## 登录项  
**编号：**T1547.015  
**战术：**持久化（Persistence）  
**数据源：**文件创建和修改日志，进行创建  
**基本描述：**攻击者可能会添加登录项从而用户登录时执行以获得持久性或升级权限。登录项是用户登录时自动启动的应用程序、文档、文件夹或服务器连接。登录项可以通过共享文件列表或服务管理框架添加。可以使用 AppleScript 等脚本语言设置共享文件列表登录项，而服务管理框架使用 API 调用 SMLoginItemSetEnabled。
使用服务管理框架安装的登录项利用 launchd，在系统首选项中不可见，只能由创建它们的应用程序删除。
攻击者可以利用 AppleScript 和 Native API 调用来创建登录项以生成恶意可执行文件。
攻击者还可以使用登录项来启动可执行文件，这些可执行文件可用于远程控制受害系统或作为通过提示用户凭据来获得权限提升的一种手段。  
## 检测建议  
通过将 Info.plist 文件中的 LSUIElement 或 LSBackgroundOnly 键设置为 true 来监视利用登录项的应用程序。
监视在登录时启动的异常或未知应用程序的进程。登录项的常用应用程序可能包括用户添加的内容以配置其用户环境。
从登录项检查正在运行的应用程序也有异常行为，例如建立网络连接。  
## 检测方式  
规则