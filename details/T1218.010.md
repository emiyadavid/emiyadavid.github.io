## Regsvr32  
**编号：**T1218.010  
**战术：**防御规避（Defense Evasion)  
**数据源：**DLL监视，进程命令行参数，进程监视，Windows注册表  
**基本描述：**Regsvr32命令用于注册COM组件，是Windows系统提供的用来向系统注册控件或者卸载控件的命令，以命令行方式运行。Regsvr32.exe 是是Microsoft签名的二进制文件，可用于执行任意二进制文件。
攻击者可以利用此功能来代理代码的执行来避免触发安全工具。由于Windows使用regsvr32.exe 进行正常操作时的白名单或误报情况，工具可能无法监视regsvr32.exe进程的执行和加载的模块。
可以利用加载 COM scriptlet 以在用户权限下执行 DLL 的功能来绕过进程白名单。
由于regsvr32.exe支持网络和代理，因此可以通过在调用期间将URL作为参数传递到外部 Web 服务器上的文件来加载脚本。
还可以利用 Regsvr32.exe来注册用于通过组件对象模型劫持（Component Object Model Hijacking）建立持久性的 COM 对象。
  
## 检测建议  
使用进程监控来监控regsvr32.exe的执行和参数。 
将regsvr32.exe最近的调用与之前的已知良好参数和被加载的文件进行比较，以确定异常和潜在的攻击活动。 regsvr32.exe 调用前后使用的命令参数也可能有助于确定执行的二进制文件的来源和目的。  
## 检测方式  
规则